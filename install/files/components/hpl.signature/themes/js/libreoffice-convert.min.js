/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/libreoffice-convert@1.3.3/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const fs=require("fs"),path=require("path"),async=require("async"),tmp=require("tmp"),{execFile:execFile}=require("child_process"),convertWithOptions=(e,r,i,n,t)=>{const o=(n||{}).tmpOptions||{},s=(n||{}).asyncOptions||{},c=tmp.dirSync({prefix:"libreofficeConvert_",unsafeCleanup:!0,...o}),a=tmp.dirSync({prefix:"soffice",unsafeCleanup:!0,...o});return async.auto({soffice:e=>{let r=[];switch(process.platform){case"darwin":r=["/Applications/LibreOffice.app/Contents/MacOS/soffice"];break;case"linux":r=["/usr/bin/libreoffice","/usr/bin/soffice","/snap/bin/libreoffice"];break;case"win32":r=[path.join(process.env["PROGRAMFILES(X86)"],"LIBREO~1/program/soffice.exe"),path.join(process.env["PROGRAMFILES(X86)"],"LibreOffice/program/soffice.exe"),path.join(process.env.PROGRAMFILES,"LibreOffice/program/soffice.exe")];break;default:return e(new Error(`Operating system not yet supported: ${process.platform}`))}return async.filter(r,((e,r)=>fs.access(e,(e=>r(null,!e)))),((r,i)=>0===i.length?e(new Error("Could not find soffice binary")):e(null,i[0])))},saveSource:r=>fs.writeFile(path.join(c.name,"source"),e,r),convert:["soffice","saveSource",(e,n)=>{let t=`-env:UserInstallation=file://${a.name} --headless --convert-to ${r}`;void 0!==i&&(t+=`:"${i}"`),t+=` --outdir ${c.name} ${path.join(c.name,"source")}`;const o=t.split(" ");return execFile(e.soffice,o,n)}],loadDestination:["convert",(e,i)=>async.retry({times:s.times||3,interval:s.interval||200},(e=>fs.readFile(path.join(c.name,`source.${r}`),e)),i)]},((e,r)=>(c.removeCallback(),a.removeCallback(),e?t(e):t(null,r.loadDestination))))},convert=(e,r,i,n)=>convertWithOptions(e,r,i,{},n);module.exports={convert:convert,convertWithOptions:convertWithOptions};
//# sourceMappingURL=/sm/16666b8ae6930a31d140471d41537c08f1c86bad359c3ce3d0c30e7189ac811b.map